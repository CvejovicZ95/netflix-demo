fix middleware, token-undefined for protect route